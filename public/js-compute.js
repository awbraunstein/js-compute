// Generated by CoffeeScript 1.3.3
(function() {
  var doWhile, runCode, start, worker,
    _this = this;

  if (typeof window === 'undefined') {
    start = function() {
      var cond, more;
      more = false;
      cond = function() {
        return more;
      };
      return doWhile(runCode, cond);
    };
    runCode = function() {
      var more, request, response, taskId;
      taskId = 3;
      importScripts("http://localhost:3000/task/" + taskId + "/work");
      response = {
        result: task(params),
        input: taskId
      };
      request = new XMLHttpRequest();
      request.open('POST', "http://localhost:3000/task/" + taskId + "/work", false);
      request.setRequestHeader("Content-type", "application/json");
      request.send(JSON.stringify(response));
      if (request.status === 200) {
        return more = JSON.parse(request.responseText).more || false;
      }
    };
    this.onmessage = function(event) {
      return start();
    };
    doWhile = function(func, condition) {
      var _results;
      func();
      _results = [];
      while (condition()) {
        _results.push(func());
      }
      return _results;
    };
  } else {
    worker = new Worker('js-compute.js');
    worker.onmessage = function(event) {
      console.log(event.data);
    };
    worker.postMessage();
  }

}).call(this);
